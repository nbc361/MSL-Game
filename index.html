<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSL Simulator - Medical Science Liaison Training Game</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="game-container">
        <!-- Loading Screen -->
        <div id="loading-screen" class="screen active">
            <div class="loading-content">
                <h1>MSL SIMULATOR</h1>
                <p class="subtitle">Medical Science Liaison Training Experience</p>
                <div class="loading-bar">
                    <div class="loading-progress"></div>
                </div>
                <p class="loading-text">Initializing simulation...</p>
            </div>
        </div>

        <!-- Title Screen -->
        <div id="title-screen" class="screen">
            <div class="title-content">
                <h1>MSL SIMULATOR</h1>
                <p class="tagline">Master the Art of Medical Science Liaison</p>
                <div class="menu-buttons">
                    <button id="new-game-btn" class="menu-btn primary">New Career</button>
                    <button id="continue-btn" class="menu-btn" disabled>Continue</button>
                    <button id="tutorial-btn" class="menu-btn">What is an MSL?</button>
                </div>
                <div class="version-info">v1.0 - Educational Simulation</div>
            </div>
        </div>

        <!-- Tutorial/Info Screen -->
        <div id="tutorial-screen" class="screen">
            <div class="tutorial-content">
                <h2>What is a Medical Science Liaison (MSL)?</h2>
                <div class="tutorial-sections">
                    <div class="tutorial-section">
                        <h3>Role Overview</h3>
                        <p>MSLs are field-based medical professionals who serve as scientific experts for pharmaceutical/biotech companies. They bridge the gap between the company and the medical community through non-promotional scientific exchange.</p>
                    </div>
                    <div class="tutorial-section">
                        <h3>Key Responsibilities</h3>
                        <ul>
                            <li><strong>Scientific Exchange:</strong> Share clinical data and answer medical questions</li>
                            <li><strong>KOL Engagement:</strong> Build relationships with Key Opinion Leaders</li>
                            <li><strong>Insight Gathering:</strong> Collect medical insights from the field</li>
                            <li><strong>Advisory Boards:</strong> Organize and facilitate expert meetings</li>
                            <li><strong>Congress Support:</strong> Represent company at medical conferences</li>
                            <li><strong>IIS Support:</strong> Facilitate Investigator-Initiated Studies</li>
                            <li><strong>Internal Training:</strong> Educate commercial teams on medical content</li>
                        </ul>
                    </div>
                    <div class="tutorial-section">
                        <h3>Critical Compliance Rules</h3>
                        <ul>
                            <li>Never promote products - MSLs engage in <strong>non-promotional</strong> activities only</li>
                            <li>Only discuss <strong>on-label</strong> information proactively</li>
                            <li>Off-label discussions only in <strong>response to unsolicited requests</strong></li>
                            <li>Document all interactions in CRM within <strong>24-48 hours</strong></li>
                            <li>Maintain clear <strong>separation from sales</strong> activities</li>
                            <li>Report <strong>adverse events</strong> within required timeframes</li>
                        </ul>
                    </div>
                </div>
                <button id="back-to-title" class="menu-btn">Back to Menu</button>
            </div>
        </div>

        <!-- Interactive Tutorial Overlay -->
        <div id="tutorial-overlay" class="tutorial-overlay">
            <div class="tutorial-backdrop"></div>
            <div class="tutorial-modal">
                <div class="tutorial-progress">
                    <div class="progress-dots" id="tutorial-progress-dots"></div>
                    <span class="progress-text" id="tutorial-progress-text">Step 1 of 7</span>
                </div>
                <div class="tutorial-content-box">
                    <div class="tutorial-icon" id="tutorial-step-icon">üéì</div>
                    <h3 id="tutorial-step-title">Welcome to MSL Simulator!</h3>
                    <p id="tutorial-step-content">Learn to navigate the world of Medical Science Liaisons through realistic scenarios and challenges.</p>
                    <div class="tutorial-tips" id="tutorial-step-tips">
                        <h4>Quick Tips:</h4>
                        <ul id="tutorial-tips-list"></ul>
                    </div>
                </div>
                <div class="tutorial-actions">
                    <button id="tutorial-skip" class="tutorial-btn secondary">Skip Tutorial</button>
                    <button id="tutorial-prev" class="tutorial-btn" style="display:none;">Previous</button>
                    <button id="tutorial-next" class="tutorial-btn primary">Next</button>
                </div>
            </div>
        </div>

        <!-- Character Creation Screen -->
        <div id="character-screen" class="screen">
            <div class="character-content">
                <h2>Create Your MSL Profile</h2>

                <div class="creation-section">
                    <label>Your Name:</label>
                    <input type="text" id="player-name" placeholder="Dr. ..." maxlength="30">
                </div>

                <div class="creation-section">
                    <label>Educational Background:</label>
                    <div class="option-grid">
                        <button class="option-btn education-btn" data-value="phd">PhD (Biomedical Sciences)</button>
                        <button class="option-btn education-btn" data-value="pharmd">PharmD</button>
                        <button class="option-btn education-btn" data-value="md">MD</button>
                        <button class="option-btn education-btn" data-value="dnp">DNP</button>
                    </div>
                    <p class="option-description" id="education-desc"></p>
                </div>

                <div class="creation-section">
                    <label>Therapeutic Area:</label>
                    <div class="option-grid">
                        <button class="option-btn ta-btn" data-value="oncology">Oncology</button>
                        <button class="option-btn ta-btn" data-value="immunology">Immunology</button>
                        <button class="option-btn ta-btn" data-value="neurology">Neurology</button>
                        <button class="option-btn ta-btn" data-value="cardiology">Cardiology</button>
                        <button class="option-btn ta-btn" data-value="rare-disease">Rare Disease</button>
                    </div>
                    <p class="option-description" id="ta-desc"></p>
                </div>

                <div class="creation-section">
                    <label>Starting Stats Preview:</label>
                    <div class="stats-preview" id="stats-preview">
                        <div class="stat-bar">
                            <span>Scientific Knowledge</span>
                            <div class="bar"><div class="fill" id="preview-science"></div></div>
                        </div>
                        <div class="stat-bar">
                            <span>Communication</span>
                            <div class="bar"><div class="fill" id="preview-comm"></div></div>
                        </div>
                        <div class="stat-bar">
                            <span>Strategic Thinking</span>
                            <div class="bar"><div class="fill" id="preview-strategy"></div></div>
                        </div>
                        <div class="stat-bar">
                            <span>Compliance Awareness</span>
                            <div class="bar"><div class="fill" id="preview-compliance"></div></div>
                        </div>
                    </div>
                </div>

                <button id="proceed-territory" class="menu-btn primary" disabled>Select Territory</button>
            </div>
        </div>

        <!-- Territory Selection Screen -->
        <div id="territory-screen" class="screen">
            <div class="territory-content">
                <h2>Select Your Territory</h2>
                <p class="territory-intro">Each territory presents unique challenges based on healthcare landscape, KOL density, and competitive environment.</p>

                <div class="territory-grid" id="territory-grid">
                    <!-- Territories will be populated by JS -->
                </div>

                <div class="territory-details" id="territory-details">
                    <h3 id="territory-name">Select a Territory</h3>
                    <div class="territory-stats" id="territory-stats"></div>
                    <p id="territory-description"></p>
                </div>

                <button id="start-career" class="menu-btn primary" disabled>Begin Your MSL Career</button>
            </div>
        </div>

        <!-- Main Game Dashboard -->
        <div id="dashboard-screen" class="screen">
            <div class="dashboard-header">
                <div class="player-info">
                    <span id="player-display-name">Dr. Smith</span>
                    <span class="player-title" id="player-title">MSL I</span>
                    <span class="player-ta" id="player-ta">Oncology</span>
                    <span class="game-date" id="current-date">Week 1, Q1 2024</span>
                </div>
                <div class="quick-stats">
                    <div class="level-display" id="level-display">
                        <!-- Level and XP bar populated by JS -->
                    </div>
                    <div class="quick-stat" title="Total KOL interactions completed this career">
                        <span class="stat-icon">üéØ</span>
                        <span id="kol-interactions">0</span>
                        <span class="stat-label">KOL Interactions</span>
                    </div>
                    <div class="quick-stat" title="Valuable medical insights gathered from KOLs">
                        <span class="stat-icon">üí°</span>
                        <span id="insights-count">0</span>
                        <span class="stat-label">Insights</span>
                    </div>
                    <div class="quick-stat compliance-stat" title="Regulatory compliance score. Stay above 70% to avoid termination.">
                        <span class="stat-icon">‚öñÔ∏è</span>
                        <span id="compliance-score">100%</span>
                        <span class="stat-label">Compliance</span>
                    </div>
                    <div class="quick-stat action-points-stat" id="action-points-display" title="Action Points reset each week. Traveling to KOLs costs AP based on distance.">
                        <span class="ap-icon">‚ö°</span>
                        <span class="ap-value">5/5</span>
                        <span class="ap-label">AP</span>
                    </div>
                </div>
                <div class="time-budget-display">
                    <div class="time-budget-header">
                        <span class="time-icon">‚è±Ô∏è</span>
                        <span class="time-label">Weekly Time Budget</span>
                        <span class="weeks-remaining" id="weeks-remaining">52 weeks remaining</span>
                    </div>
                    <div class="time-budget-bar">
                        <div class="time-budget-fill" id="time-budget-fill"></div>
                    </div>
                    <div class="time-budget-text">
                        <span id="time-remaining">40</span> / <span id="time-total">40</span> hours
                    </div>
                    <button id="advance-time" class="advance-day-btn">
                        <span class="advance-icon">‚è≠Ô∏è</span>
                        <span>Advance Day</span>
                    </button>
                </div>
            </div>

            <div class="dashboard-main">
                <div class="dashboard-nav">
                    <button class="nav-btn active" data-panel="territory-map">Territory Map</button>
                    <button class="nav-btn" data-panel="calendar">Calendar</button>
                    <button class="nav-btn" data-panel="kol-database">KOL Database</button>
                    <button class="nav-btn" data-panel="crm">CRM</button>
                    <button class="nav-btn" data-panel="skills">Skills</button>
                    <button class="nav-btn" data-panel="insights-panel">Insights</button>
                    <button class="nav-btn" data-panel="performance">Performance</button>
                </div>

                <div class="dashboard-panels">
                    <!-- Territory Map Panel -->
                    <div class="panel active" id="territory-map">
                        <h3>Territory Overview</h3>
                        <div class="map-container" id="map-container">
                            <!-- Interactive map will be rendered here -->
                        </div>
                        <div class="map-legend">
                            <div class="legend-item"><span class="dot academic"></span> Academic Medical Center</div>
                            <div class="legend-item"><span class="dot community"></span> Community Hospital</div>
                            <div class="legend-item"><span class="dot practice"></span> Private Practice</div>
                            <div class="legend-item"><span class="dot research"></span> Research Institution</div>
                        </div>
                    </div>

                    <!-- Calendar Panel -->
                    <div class="panel" id="calendar">
                        <h3>Weekly Schedule</h3>
                        <div class="calendar-grid" id="calendar-grid">
                            <!-- Calendar will be populated by JS -->
                        </div>
                        <div class="upcoming-events">
                            <h4>Upcoming Events</h4>
                            <div id="events-list"></div>
                        </div>
                    </div>

                    <!-- KOL Database Panel -->
                    <div class="panel" id="kol-database">
                        <h3>Key Opinion Leaders</h3>
                        <div class="kol-filters">
                            <select id="kol-filter-tier">
                                <option value="all">All Tiers</option>
                                <option value="1">Tier 1 (National)</option>
                                <option value="2">Tier 2 (Regional)</option>
                                <option value="3">Tier 3 (Local)</option>
                            </select>
                            <select id="kol-filter-relationship">
                                <option value="all">All Relationships</option>
                                <option value="new">New</option>
                                <option value="developing">Developing</option>
                                <option value="established">Established</option>
                                <option value="advocate">Advocate</option>
                            </select>
                        </div>
                        <div class="kol-list" id="kol-list">
                            <!-- KOL cards will be populated by JS -->
                        </div>
                    </div>

                    <!-- CRM Panel -->
                    <div class="panel" id="crm">
                        <h3>CRM Documentation</h3>
                        <div class="crm-status">
                            <div class="crm-stat">
                                <span class="crm-number" id="pending-docs">0</span>
                                <span>Pending Documentation</span>
                            </div>
                            <div class="crm-stat">
                                <span class="crm-number" id="overdue-docs">0</span>
                                <span>Overdue (>48hrs)</span>
                            </div>
                        </div>
                        <div class="crm-entries" id="crm-entries">
                            <!-- CRM entries will be populated by JS -->
                        </div>
                    </div>

                    <!-- Skills Panel -->
                    <div class="panel" id="skills">
                        <h3>Skill Development</h3>
                        <div class="skill-points-display">
                            <span>Available Skill Points: </span>
                            <span id="available-skill-points">0</span>
                        </div>
                        <div class="skill-tree" id="skill-tree">
                            <!-- Skill tree will be populated by JS -->
                        </div>
                    </div>

                    <!-- Insights Panel -->
                    <div class="panel" id="insights-panel">
                        <h3>Medical Insights</h3>
                        <div class="insights-categories">
                            <button class="insight-cat-btn active" data-cat="all">All</button>
                            <button class="insight-cat-btn" data-cat="unmet-need">Unmet Needs</button>
                            <button class="insight-cat-btn" data-cat="competitive">Competitive Intel</button>
                            <button class="insight-cat-btn" data-cat="clinical">Clinical Practice</button>
                            <button class="insight-cat-btn" data-cat="safety">Safety</button>
                        </div>
                        <div class="insights-list" id="insights-list">
                            <!-- Insights will be populated by JS -->
                        </div>
                        <div class="insights-summary">
                            <h4>Quarterly Insight Summary</h4>
                            <div id="insight-summary-chart"></div>
                        </div>
                    </div>

                    <!-- Performance Panel -->
                    <div class="panel" id="performance">
                        <h3>Performance Metrics</h3>
                        <div class="performance-grid">
                            <div class="metric-card">
                                <h4>KOL Engagement</h4>
                                <div class="metric-value" id="metric-kol">0%</div>
                                <div class="metric-target">Target: 80%</div>
                            </div>
                            <div class="metric-card">
                                <h4>Scientific Exchange Quality</h4>
                                <div class="metric-value" id="metric-exchange">0%</div>
                                <div class="metric-target">Target: 85%</div>
                            </div>
                            <div class="metric-card">
                                <h4>Insight Generation</h4>
                                <div class="metric-value" id="metric-insights">0%</div>
                                <div class="metric-target">Target: 75%</div>
                            </div>
                            <div class="metric-card">
                                <h4>CRM Compliance</h4>
                                <div class="metric-value" id="metric-crm">100%</div>
                                <div class="metric-target">Target: 95%</div>
                            </div>
                            <div class="metric-card crm-quality-card">
                                <h4>CRM Doc Quality</h4>
                                <div class="metric-value" id="metric-crm-avg">-</div>
                                <div class="crm-grade-breakdown" id="crm-grade-breakdown">
                                    <span class="grade-stat a">A: <span id="crm-grade-a">0</span></span>
                                    <span class="grade-stat b">B: <span id="crm-grade-b">0</span></span>
                                    <span class="grade-stat c">C: <span id="crm-grade-c">0</span></span>
                                </div>
                            </div>
                            <div class="metric-card">
                                <h4>Regulatory Compliance</h4>
                                <div class="metric-value" id="metric-compliance">100%</div>
                                <div class="metric-target">Target: 100%</div>
                            </div>
                            <div class="metric-card">
                                <h4>Internal Collaboration</h4>
                                <div class="metric-value" id="metric-collab">0%</div>
                                <div class="metric-target">Target: 70%</div>
                            </div>
                        </div>
                        <div class="review-status" id="review-status">
                            <h4>Next Performance Review</h4>
                            <p id="next-review">End of Q1</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pending AE Alert -->
            <div class="pending-ae-alert" id="pending-ae-alert" style="display: none;" onclick="game.openAEModal()">
                <div class="alert-icon">‚ö†Ô∏è</div>
                <div class="alert-content">
                    <h4>Pending Adverse Event Report</h4>
                    <p id="pending-ae-message">1 adverse event requires documentation within 24 hours</p>
                </div>
                <div class="alert-action">
                    <span class="arrow">‚Üí</span>
                </div>
            </div>

            <!-- Next Action Prompt -->
            <div class="next-action-prompt" id="next-action-prompt">
                <div class="prompt-icon" id="prompt-icon">üí°</div>
                <div class="prompt-content">
                    <h4 id="prompt-title">Suggested Next Action</h4>
                    <p id="prompt-message">Welcome! Start by visiting KOLs in your territory to build relationships.</p>
                </div>
                <button class="prompt-action-btn" id="prompt-action-btn">
                    <span id="prompt-action-text">Visit a KOL</span>
                    <span class="arrow">‚Üí</span>
                </button>
            </div>

            <!-- Collapsible Action Menu -->
            <div class="action-menu-container" id="action-menu-container">
                <button class="action-menu-toggle" id="action-menu-toggle" title="Toggle Actions Menu">
                    <span class="toggle-icon">‚ñ∂</span>
                    <span class="toggle-label">Actions</span>
                </button>
                <div class="action-menu" id="action-menu">
                    <div class="action-menu-header">
                        <h4>MSL Activities</h4>
                        <button class="close-menu-btn" id="close-action-menu">√ó</button>
                    </div>
                    <div class="action-menu-items">
                        <button id="action-visit-kol" class="action-menu-btn" title="Visit a KOL in person. Higher AP cost but builds stronger relationships.">
                            <span class="action-icon">üë§</span>
                            <div class="action-info">
                                <span class="action-name">Visit KOL (In-Person)</span>
                                <span class="action-desc">In-person scientific exchange</span>
                            </div>
                            <span class="action-cost">1-3 AP</span>
                        </button>
                        <button id="action-virtual-call" class="action-menu-btn" title="Schedule a virtual call with a KOL. Lower AP cost (1 AP) but reduced relationship building compared to in-person visits.">
                            <span class="action-icon">üíª</span>
                            <div class="action-info">
                                <span class="action-name">Virtual Call</span>
                                <span class="action-desc">Remote scientific exchange</span>
                            </div>
                            <span class="action-cost">1 AP</span>
                        </button>
                        <button id="action-congress" class="action-menu-btn" title="Attend a medical congress to network with multiple KOLs and learn about the latest research.">
                            <span class="action-icon">üèõÔ∏è</span>
                            <div class="action-info">
                                <span class="action-name">Congress</span>
                                <span class="action-desc">Medical conference attendance</span>
                            </div>
                            <span class="action-cost">3 AP</span>
                        </button>
                        <button id="action-advisory" class="action-menu-btn" title="Organize or participate in advisory board meetings with expert KOLs. Builds strong relationships.">
                            <span class="action-icon">üìã</span>
                            <div class="action-info">
                                <span class="action-name">Advisory Board</span>
                                <span class="action-desc">Expert panel meetings</span>
                            </div>
                            <span class="action-cost">2 AP</span>
                        </button>
                        <button id="action-training" class="action-menu-btn" title="Conduct internal training sessions to share field insights with your colleagues.">
                            <span class="action-icon">üìö</span>
                            <div class="action-info">
                                <span class="action-name">Internal Training</span>
                                <span class="action-desc">Share field insights</span>
                            </div>
                            <span class="action-cost">1 AP</span>
                        </button>
                        <button id="action-iis" class="action-menu-btn" title="Support Investigator-Initiated Studies by helping KOLs with research proposals.">
                            <span class="action-icon">üî¨</span>
                            <div class="action-info">
                                <span class="action-name">IIS Support</span>
                                <span class="action-desc">Research collaboration</span>
                            </div>
                            <span class="action-cost">1 AP</span>
                        </button>
                        <button id="action-trip-planner" class="action-menu-btn" title="Plan a multi-visit trip to see up to 3 KOLs in the same area for the cost of one trip.">
                            <span class="action-icon">üó∫Ô∏è</span>
                            <div class="action-info">
                                <span class="action-name">Plan Trip</span>
                                <span class="action-desc">Multi-KOL visit (up to 3)</span>
                            </div>
                            <span class="action-cost">Max AP</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- KOL Interaction Screen -->
        <div id="interaction-screen" class="screen fullscreen-mode">
            <div class="screen-nav">
                <button id="back-from-interaction" class="back-btn">
                    <span class="back-icon">‚Üê</span>
                    <span>Back to Dashboard</span>
                </button>
                <div class="breadcrumb">
                    <span>Dashboard</span> / <span>KOL Interaction</span>
                </div>
            </div>

            <div class="interaction-container">
                <div class="interaction-header">
                    <div class="kol-profile">
                        <div class="kol-avatar large" id="interaction-avatar">üë®‚Äç‚öïÔ∏è</div>
                        <div class="kol-info">
                            <h2 id="interaction-kol-name">Dr. James Wilson</h2>
                            <p id="interaction-kol-title">Professor of Oncology</p>
                            <p id="interaction-kol-institution">Memorial Cancer Center</p>
                        </div>
                    </div>
                    <div class="interaction-stats">
                        <div class="interaction-stat">
                            <span class="stat-label">Relationship</span>
                            <div class="relationship-bar">
                                <div class="relationship-fill" id="relationship-fill"></div>
                            </div>
                            <span class="relationship-level" id="relationship-label">New</span>
                        </div>
                    </div>
                </div>

                <div class="interaction-main">
                    <div class="dialogue-container">
                        <div class="dialogue-history" id="dialogue-history">
                            <!-- Dialogue will be populated here -->
                        </div>
                        <div class="dialogue-options" id="dialogue-options">
                            <!-- Response options will appear here -->
                        </div>
                    </div>

                    <div class="interaction-sidebar">
                        <div class="sidebar-section kol-details">
                            <h4>About This KOL</h4>
                            <div id="kol-background-info">
                                <p class="kol-detail"><strong>Specialty:</strong> <span id="kol-specialty"></span></p>
                                <p class="kol-detail"><strong>Interests:</strong> <span id="kol-interests"></span></p>
                                <p class="kol-detail"><strong>Previous Interactions:</strong> <span id="kol-prev-interactions">0</span></p>
                            </div>
                        </div>
                        <div class="sidebar-section">
                            <h4>Compliance Status</h4>
                            <div class="compliance-indicator" id="compliance-indicator">
                                <span class="status-dot green"></span>
                                <span>Active conversation</span>
                            </div>
                        </div>
                        <div class="sidebar-section">
                            <h4>Your Notes</h4>
                            <textarea id="interaction-notes" placeholder="Take notes during this interaction..."></textarea>
                        </div>
                        <div class="sidebar-section">
                            <button id="end-interaction" class="action-btn full-width">End Interaction</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CRM Documentation Modal (Simplified) -->
        <div id="crm-modal" class="modal">
            <div class="modal-content crm-form">
                <h2>Document Interaction</h2>

                <div class="crm-quality-indicator" id="crm-quality-indicator">
                    <div class="quality-header">
                        <div class="quality-label">Quality</div>
                        <div class="quality-grade" id="crm-quality-grade">-</div>
                    </div>
                    <div class="quality-bar">
                        <div class="quality-fill" id="crm-quality-fill"></div>
                    </div>
                    <div class="quality-score" id="crm-quality-score">0%</div>
                </div>

                <div class="crm-compact-row">
                    <div class="form-group">
                        <label>KOL</label>
                        <input type="text" id="crm-kol-name" readonly>
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="crm-interaction-type" class="crm-scored-field">
                            <option value="">Select...</option>
                            <option value="face-to-face">Face-to-Face</option>
                            <option value="virtual">Virtual</option>
                            <option value="phone">Phone</option>
                            <option value="congress">Congress</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Duration</label>
                        <select id="crm-duration" class="crm-scored-field">
                            <option value="">Select...</option>
                            <option value="brief">&lt;15 min</option>
                            <option value="standard">15-30 min</option>
                            <option value="extended">30-60 min</option>
                            <option value="long">&gt;60 min</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Topics Discussed</label>
                    <div class="checkbox-group compact">
                        <label><input type="checkbox" name="topics" value="efficacy" class="crm-scored-field"> Efficacy</label>
                        <label><input type="checkbox" name="topics" value="safety" class="crm-scored-field"> Safety</label>
                        <label><input type="checkbox" name="topics" value="dosing" class="crm-scored-field"> Dosing</label>
                        <label><input type="checkbox" name="topics" value="clinical-trial" class="crm-scored-field"> Clinical Trials</label>
                        <label><input type="checkbox" name="topics" value="real-world" class="crm-scored-field"> Real-World</label>
                        <label><input type="checkbox" name="topics" value="guidelines" class="crm-scored-field"> Guidelines</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Discussion Summary <span class="field-hint">(50+ chars)</span></label>
                    <textarea id="crm-discussion-summary" class="crm-scored-field" placeholder="Key topics, questions, and your responses..." rows="3"></textarea>
                    <div class="char-count"><span id="summary-char-count">0</span>/50</div>
                </div>

                <div class="crm-compact-row">
                    <div class="form-group">
                        <label>KOL Reception</label>
                        <select id="crm-sentiment" class="crm-scored-field">
                            <option value="">Select...</option>
                            <option value="very-positive">Very Positive</option>
                            <option value="positive">Positive</option>
                            <option value="neutral">Neutral</option>
                            <option value="skeptical">Skeptical</option>
                            <option value="negative">Negative</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Insight Category</label>
                        <select id="crm-insight-category">
                            <option value="">None</option>
                            <option value="unmet-need">Unmet Need</option>
                            <option value="competitive">Competitive</option>
                            <option value="clinical">Clinical</option>
                            <option value="safety">Safety</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Follow-up Actions & Insights <span class="field-hint">(optional bonus)</span></label>
                    <textarea id="crm-followup" class="crm-scored-field" placeholder="Any follow-ups committed or insights gathered..." rows="2"></textarea>
                </div>

                <!-- Hidden fields for compatibility -->
                <input type="hidden" id="crm-insights" value="">
                <input type="hidden" id="crm-next-steps" value="">
                <input type="hidden" id="crm-offlabel-details" value="">
                <input type="hidden" id="crm-ae-details" value="">

                <div class="crm-flags">
                    <label class="flag-option"><input type="checkbox" id="crm-offlabel-flag"> Off-label discussed</label>
                    <label class="flag-option"><input type="checkbox" id="crm-ae-flag"> AE to report</label>
                </div>

                <div class="modal-actions">
                    <button id="submit-crm" class="action-btn primary">Submit</button>
                    <button id="cancel-crm" class="action-btn" onclick="game.closeModal('crm-modal')">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Adverse Event Reporting Modal -->
        <div id="ae-modal" class="modal">
            <div class="modal-content ae-report-form">
                <div class="ae-header">
                    <div class="ae-urgent-badge">‚ö†Ô∏è PHARMACOVIGILANCE REQUIRED</div>
                    <h2>Adverse Event Report</h2>
                    <p class="ae-reminder">Complete this report within <span id="ae-deadline" class="deadline">24 hours</span></p>
                </div>

                <div class="ae-timer" id="ae-timer">
                    <div class="timer-icon">‚è±Ô∏è</div>
                    <div class="timer-text">Time Remaining: <span id="ae-time-remaining">24:00:00</span></div>
                </div>

                <div class="form-group">
                    <label>Source of AE Information</label>
                    <select id="ae-source">
                        <option value="">Select source...</option>
                        <option value="hcp-direct">HCP Direct Report</option>
                        <option value="hcp-secondhand">HCP Second-hand Report</option>
                        <option value="patient-direct">Patient Direct Report</option>
                        <option value="literature">Published Literature</option>
                        <option value="social-media">Social Media/Online</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Event Description <span class="field-hint">*Required</span></label>
                    <textarea id="ae-description" placeholder="Describe the adverse event in detail: What happened? When did it occur? What was the outcome?"></textarea>
                </div>

                <div class="form-group">
                    <label>Severity Assessment</label>
                    <div class="severity-options">
                        <label class="severity-option mild">
                            <input type="radio" name="ae-severity" value="mild">
                            <span class="severity-label">Mild</span>
                            <span class="severity-desc">No intervention needed</span>
                        </label>
                        <label class="severity-option moderate">
                            <input type="radio" name="ae-severity" value="moderate">
                            <span class="severity-label">Moderate</span>
                            <span class="severity-desc">Treatment modification</span>
                        </label>
                        <label class="severity-option severe">
                            <input type="radio" name="ae-severity" value="severe">
                            <span class="severity-label">Severe</span>
                            <span class="severity-desc">Hospitalization required</span>
                        </label>
                        <label class="severity-option serious">
                            <input type="radio" name="ae-severity" value="serious">
                            <span class="severity-label">Serious</span>
                            <span class="severity-desc">Life-threatening/Death</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Is this event expected based on known safety profile?</label>
                    <div class="radio-group">
                        <label><input type="radio" name="ae-expected" value="yes"> Yes - Listed in prescribing information</label>
                        <label><input type="radio" name="ae-expected" value="no"> No - Unexpected adverse event</label>
                        <label><input type="radio" name="ae-expected" value="unknown"> Unknown</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Reporter Information</label>
                    <input type="text" id="ae-reporter-name" placeholder="Reporter name (HCP or patient)">
                    <input type="text" id="ae-reporter-contact" placeholder="Contact information (phone/email)">
                </div>

                <div class="form-group">
                    <label>Additional Notes</label>
                    <textarea id="ae-additional-notes" placeholder="Any additional relevant information: concomitant medications, medical history, etc."></textarea>
                </div>

                <div class="ae-compliance-note">
                    <strong>Reminder:</strong> All adverse events must be reported regardless of causality assessment.
                    Failure to report AEs promptly is a serious regulatory violation.
                </div>

                <div class="modal-actions">
                    <button id="submit-ae" class="action-btn primary">Submit AE Report</button>
                    <button id="cancel-ae" class="action-btn">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Pre-Call Planning Modal -->
        <div id="precall-modal" class="modal">
            <div class="modal-content precall-planning">
                <h2>Pre-Call Planning</h2>
                <p class="planning-subtitle">Prepare your objectives before meeting with the KOL</p>

                <div class="precall-kol-info">
                    <div class="precall-avatar" id="precall-avatar">üë®‚Äç‚öïÔ∏è</div>
                    <div class="precall-details">
                        <h3 id="precall-kol-name">Dr. Name</h3>
                        <p id="precall-kol-title">Title</p>
                        <p id="precall-kol-institution">Institution</p>
                        <p class="kol-location-info">üìç <span id="precall-location">City, ST</span></p>
                    </div>
                    <div class="precall-stats">
                        <div class="precall-stat">
                            <span class="label">Tier</span>
                            <span class="value" id="precall-tier">1</span>
                        </div>
                        <div class="precall-stat">
                            <span class="label">Relationship</span>
                            <span class="value" id="precall-relationship">New</span>
                        </div>
                        <div class="precall-stat">
                            <span class="label">Personality</span>
                            <span class="value" id="precall-personality">Unknown</span>
                        </div>
                        <div class="precall-stat">
                            <span class="label">Last Contact</span>
                            <span class="value" id="precall-last-contact">Never</span>
                        </div>
                    </div>
                </div>

                <div class="precall-two-column">
                    <div class="precall-section">
                        <h4>üìö Recent Publications</h4>
                        <div id="precall-publications" class="precall-publications">
                            <!-- Will be populated by JS -->
                        </div>
                    </div>

                    <div class="precall-section">
                        <h4>üìù Previous Interaction Notes</h4>
                        <div id="precall-previous-notes" class="precall-previous-notes">
                            <p>No previous interactions recorded.</p>
                        </div>
                    </div>
                </div>

                <div class="precall-section">
                    <h4>üéØ KOL Interests & Preferences</h4>
                    <div id="precall-interests" class="precall-interests">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <div class="precall-section">
                    <h4>Set Meeting Objectives (Select 1-3)</h4>
                    <div class="objective-grid">
                        <label class="objective-option">
                            <input type="checkbox" name="objectives" value="scientific-exchange">
                            <span class="objective-label">
                                <span class="objective-icon">üî¨</span>
                                <span class="objective-text">Scientific Exchange</span>
                                <span class="objective-desc">Share clinical data and answer medical questions</span>
                            </span>
                        </label>
                        <label class="objective-option">
                            <input type="checkbox" name="objectives" value="gather-insights">
                            <span class="objective-label">
                                <span class="objective-icon">üí°</span>
                                <span class="objective-text">Gather Insights</span>
                                <span class="objective-desc">Learn about clinical practice patterns and unmet needs</span>
                            </span>
                        </label>
                        <label class="objective-option">
                            <input type="checkbox" name="objectives" value="build-relationship">
                            <span class="objective-label">
                                <span class="objective-icon">ü§ù</span>
                                <span class="objective-text">Build Relationship</span>
                                <span class="objective-desc">Deepen professional rapport and trust</span>
                            </span>
                        </label>
                        <label class="objective-option">
                            <input type="checkbox" name="objectives" value="discuss-research">
                            <span class="objective-label">
                                <span class="objective-icon">üìä</span>
                                <span class="objective-text">Discuss Research</span>
                                <span class="objective-desc">Explore IIS opportunities or clinical trial updates</span>
                            </span>
                        </label>
                        <label class="objective-option">
                            <input type="checkbox" name="objectives" value="address-concerns">
                            <span class="objective-label">
                                <span class="objective-icon">‚ùì</span>
                                <span class="objective-text">Address Concerns</span>
                                <span class="objective-desc">Handle questions about safety, efficacy, or access</span>
                            </span>
                        </label>
                        <label class="objective-option">
                            <input type="checkbox" name="objectives" value="competitive-intel">
                            <span class="objective-label">
                                <span class="objective-icon">üìã</span>
                                <span class="objective-text">Competitive Landscape</span>
                                <span class="objective-desc">Understand positioning vs. other treatments</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="precall-section">
                    <h4>Key Questions to Address</h4>
                    <textarea id="precall-questions" placeholder="Note any specific questions you want to ask or topics to discuss..."></textarea>
                </div>

                <div class="precall-section">
                    <h4>Materials to Bring</h4>
                    <div class="materials-grid">
                        <label class="material-option">
                            <input type="checkbox" name="materials" value="prescribing-info">
                            <span>Prescribing Information</span>
                        </label>
                        <label class="material-option">
                            <input type="checkbox" name="materials" value="clinical-reprints">
                            <span>Clinical Trial Reprints</span>
                        </label>
                        <label class="material-option">
                            <input type="checkbox" name="materials" value="safety-data">
                            <span>Safety Data Summary</span>
                        </label>
                        <label class="material-option">
                            <input type="checkbox" name="materials" value="rwe-data">
                            <span>Real-World Evidence</span>
                        </label>
                        <label class="material-option">
                            <input type="checkbox" name="materials" value="dosing-cards">
                            <span>Dosing Cards</span>
                        </label>
                        <label class="material-option">
                            <input type="checkbox" name="materials" value="iis-info">
                            <span>IIS Program Information</span>
                        </label>
                    </div>
                </div>

                <div class="precall-tips">
                    <h4>Planning Tips</h4>
                    <ul id="precall-tips-list">
                        <!-- Tips populated by JS based on KOL -->
                    </ul>
                </div>

                <div class="modal-actions">
                    <button id="start-meeting" class="action-btn primary">Start Meeting</button>
                    <button id="cancel-planning" class="action-btn">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Compliance Warning Modal -->
        <div id="compliance-modal" class="modal">
            <div class="modal-content compliance-warning">
                <div class="warning-icon">‚ö†Ô∏è</div>
                <h2>Compliance Alert</h2>
                <p id="compliance-message"></p>
                <div class="compliance-options" id="compliance-options">
                    <!-- Options will be populated by JS -->
                </div>
            </div>
        </div>

        <!-- Advisory Board Screen -->
        <div id="advisory-screen" class="screen fullscreen-mode">
            <div class="screen-nav">
                <button id="back-to-dashboard" class="back-btn">
                    <span class="back-icon">‚Üê</span>
                    <span>Back to Dashboard</span>
                </button>
                <div class="breadcrumb">
                    <span>Dashboard</span> / <span>Advisory Board</span>
                </div>
            </div>

            <div class="screen-content">
                <div class="advisory-header">
                    <h2>Advisory Board Planning</h2>
                    <p>Organize expert meetings to gather insights and inform medical strategy</p>
                </div>

                <div class="advisory-content">
                    <div class="advisory-planning" id="advisory-planning">
                        <h3>Plan New Advisory Board</h3>

                        <div class="form-group">
                            <label>Meeting Topic</label>
                            <select id="advisory-topic">
                                <option value="">Select topic...</option>
                                <option value="treatment-landscape">Treatment Landscape Assessment</option>
                                <option value="clinical-data">Clinical Data Review</option>
                                <option value="unmet-needs">Unmet Needs Exploration</option>
                                <option value="real-world">Real-World Evidence Discussion</option>
                                <option value="guidelines">Guideline Implications</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Select Advisors (3-8 recommended)</label>
                            <div class="advisor-selection" id="advisor-selection">
                                <!-- KOL selection will be populated by JS -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Meeting Format</label>
                            <div class="radio-group">
                                <label><input type="radio" name="format" value="in-person"> In-Person</label>
                                <label><input type="radio" name="format" value="virtual" checked> Virtual</label>
                                <label><input type="radio" name="format" value="hybrid"> Hybrid</label>
                            </div>
                        </div>

                        <div class="advisory-preview">
                            <h4>Estimated Outcomes</h4>
                            <div id="advisory-preview-content">
                                <p>Select advisors to see projected outcomes...</p>
                            </div>
                        </div>

                        <button id="submit-advisory" class="action-btn primary" disabled>Submit for Approval</button>
                    </div>

                    <div class="advisory-history">
                        <h3>Past Advisory Boards</h3>
                        <div id="advisory-history-list">
                            <!-- Past advisory boards will be listed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Congress Screen -->
        <div id="congress-screen" class="screen fullscreen-mode">
            <div class="screen-nav">
                <button id="leave-congress" class="back-btn">
                    <span class="back-icon">‚Üê</span>
                    <span>Leave Congress</span>
                </button>
                <div class="breadcrumb">
                    <span>Dashboard</span> / <span>Congress</span>
                </div>
            </div>

            <div class="screen-content">
                <div class="congress-header">
                    <h2 id="congress-name">ASCO Annual Meeting</h2>
                    <p id="congress-dates">June 2-6, 2024 | Chicago, IL</p>
                </div>

                <div class="congress-content">
                    <div class="congress-schedule">
                        <h3>Your Congress Schedule</h3>
                        <div class="schedule-day" id="congress-schedule">
                            <!-- Schedule will be populated by JS -->
                        </div>
                    </div>

                    <div class="congress-activities">
                        <h3>Available Activities</h3>
                        <div class="activity-list">
                            <button class="activity-btn" data-activity="booth">
                                <span class="activity-icon">üè¢</span>
                                <span>Staff Medical Booth</span>
                                <span class="activity-desc">Answer HCP questions at the medical information booth</span>
                            </button>
                            <button class="activity-btn" data-activity="poster">
                                <span class="activity-icon">üìä</span>
                                <span>Poster Presentation Support</span>
                                <span class="activity-desc">Support investigators presenting company-sponsored research</span>
                            </button>
                            <button class="activity-btn" data-activity="symposium">
                                <span class="activity-icon">üé§</span>
                                <span>Attend Scientific Symposium</span>
                                <span class="activity-desc">Learn about latest research in your therapeutic area</span>
                            </button>
                            <button class="activity-btn" data-activity="networking">
                                <span class="activity-icon">ü§ù</span>
                                <span>KOL Networking</span>
                                <span class="activity-desc">Connect with KOLs in informal setting</span>
                            </button>
                            <button class="activity-btn" data-activity="competitive">
                                <span class="activity-icon">üîç</span>
                                <span>Competitive Intelligence</span>
                                <span class="activity-desc">Gather information on competitor presentations</span>
                            </button>
                        </div>
                    </div>

                    <div class="congress-kols">
                        <h3>KOLs at Congress</h3>
                        <div id="congress-kol-list">
                            <!-- KOLs attending will be listed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- IIS Screen -->
        <div id="iis-screen" class="screen fullscreen-mode">
            <div class="screen-nav">
                <button id="back-from-iis" class="back-btn">
                    <span class="back-icon">‚Üê</span>
                    <span>Back to Dashboard</span>
                </button>
                <div class="breadcrumb">
                    <span>Dashboard</span> / <span>IIS Management</span>
                </div>
            </div>

            <div class="screen-content">
                <div class="iis-header">
                    <h2>Investigator-Initiated Studies (IIS)</h2>
                    <p>Support investigators interested in conducting independent research</p>
                </div>

                <div class="iis-content">
                    <div class="iis-pipeline">
                        <h3>IIS Pipeline</h3>
                        <div class="pipeline-stages">
                            <div class="stage">
                                <h4>Inquiry</h4>
                                <div class="stage-items" id="iis-inquiry"></div>
                            </div>
                            <div class="stage">
                                <h4>Under Review</h4>
                                <div class="stage-items" id="iis-review"></div>
                            </div>
                            <div class="stage">
                                <h4>Approved</h4>
                                <div class="stage-items" id="iis-approved"></div>
                            </div>
                            <div class="stage">
                                <h4>Active</h4>
                                <div class="stage-items" id="iis-active"></div>
                            </div>
                            <div class="stage">
                                <h4>Completed</h4>
                                <div class="stage-items" id="iis-completed"></div>
                            </div>
                        </div>
                    </div>

                    <div class="iis-details" id="iis-details">
                        <h3>Study Details</h3>
                        <p>Select a study to view details...</p>
                    </div>

                    <div class="iis-actions">
                        <h3>MSL Actions</h3>
                        <p class="iis-reminder">Remember: MSLs facilitate but do not design or influence IIS protocols</p>
                        <div class="iis-action-list">
                            <button class="iis-action-btn" data-action="inquiry">
                                <span>Process New Inquiry</span>
                            </button>
                            <button class="iis-action-btn" data-action="update">
                                <span>Provide Study Update</span>
                            </button>
                            <button class="iis-action-btn" data-action="site-visit">
                                <span>Conduct Site Visit</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Review Screen -->
        <div id="review-screen" class="screen">
            <div class="review-content">
                <h2>Quarterly Performance Review</h2>
                <p class="review-period" id="review-period">Q1 2024</p>

                <div class="review-summary">
                    <div class="review-section">
                        <h3>KOL Engagement</h3>
                        <div class="review-metric">
                            <div class="metric-bar">
                                <div class="metric-fill" id="review-kol-fill"></div>
                            </div>
                            <span id="review-kol-score">0%</span>
                        </div>
                        <p id="review-kol-feedback"></p>
                    </div>

                    <div class="review-section">
                        <h3>Scientific Exchange Quality</h3>
                        <div class="review-metric">
                            <div class="metric-bar">
                                <div class="metric-fill" id="review-exchange-fill"></div>
                            </div>
                            <span id="review-exchange-score">0%</span>
                        </div>
                        <p id="review-exchange-feedback"></p>
                    </div>

                    <div class="review-section">
                        <h3>Insight Generation</h3>
                        <div class="review-metric">
                            <div class="metric-bar">
                                <div class="metric-fill" id="review-insights-fill"></div>
                            </div>
                            <span id="review-insights-score">0%</span>
                        </div>
                        <p id="review-insights-feedback"></p>
                    </div>

                    <div class="review-section">
                        <h3>Compliance</h3>
                        <div class="review-metric">
                            <div class="metric-bar">
                                <div class="metric-fill" id="review-compliance-fill"></div>
                            </div>
                            <span id="review-compliance-score">100%</span>
                        </div>
                        <p id="review-compliance-feedback"></p>
                    </div>

                    <div class="review-section">
                        <h3>CRM Documentation</h3>
                        <div class="review-metric">
                            <div class="metric-bar">
                                <div class="metric-fill" id="review-crm-fill"></div>
                            </div>
                            <span id="review-crm-score">0%</span>
                        </div>
                        <p id="review-crm-feedback"></p>
                    </div>
                </div>

                <div class="review-outcome" id="review-outcome">
                    <!-- Outcome will be populated by JS -->
                </div>

                <button id="continue-after-review" class="action-btn primary">Continue</button>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameover-screen" class="screen">
            <div class="gameover-content">
                <h2 id="gameover-title">Career Update</h2>
                <div class="gameover-icon" id="gameover-icon">üìã</div>
                <p id="gameover-message"></p>
                <div class="gameover-stats" id="gameover-stats">
                    <!-- Final stats will be shown here -->
                </div>
                <div class="gameover-actions">
                    <button id="try-again" class="action-btn primary">Try Again</button>
                    <button id="main-menu" class="action-btn">Main Menu</button>
                </div>
            </div>
        </div>

        <!-- Trip Planner Modal -->
        <div id="trip-planner-modal" class="modal">
            <div class="modal-content trip-planner-content">
                <h2>Plan Multi-Visit Trip</h2>
                <p class="trip-instructions">Select up to 3 KOLs in the same area. You'll pay only the highest single AP cost for the entire trip.</p>
                <div id="trip-kol-selection" class="trip-kol-selection">
                    <!-- KOL selection rows populated by JS -->
                </div>
                <div id="trip-summary" class="trip-summary">
                    <!-- Trip summary populated by JS -->
                </div>
                <div class="trip-actions">
                    <button id="start-trip-btn" class="action-btn primary">Start Trip</button>
                    <button id="cancel-trip-btn" class="action-btn">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Notification System -->
        <div id="notification-container"></div>

        <!-- Resource Modal -->
        <div id="resource-modal" class="modal">
            <div class="modal-content">
                <h2>Approved Resources</h2>
                <div class="resource-list" id="resource-list">
                    <!-- Resources will be populated by JS -->
                </div>
                <button class="close-modal">Close</button>
            </div>
        </div>

        <!-- Training Screen -->
        <div id="training-screen" class="screen fullscreen-mode">
            <div class="screen-nav">
                <button id="back-from-training" class="back-btn">
                    <span class="back-icon">‚Üê</span>
                    <span>Back to Dashboard</span>
                </button>
                <div class="breadcrumb">
                    <span>Dashboard</span> / <span>Internal Training</span>
                </div>
            </div>

            <div class="screen-content">
                <div class="training-content">
                    <h2>Internal Training Session</h2>
                    <p>Share your medical expertise with internal stakeholders</p>

                    <div class="training-options">
                        <div class="training-card" data-training="sales">
                            <h3>Sales Team Training</h3>
                            <p>Provide disease state education and product knowledge training</p>
                            <span class="training-reward">+10 Internal Collaboration</span>
                        </div>
                        <div class="training-card" data-training="marketing">
                            <h3>Marketing Review</h3>
                            <p>Review promotional materials for medical accuracy</p>
                            <span class="training-reward">+5 Compliance Score</span>
                        </div>
                        <div class="training-card" data-training="medical">
                            <h3>Medical Team Update</h3>
                            <p>Share field insights with medical affairs colleagues</p>
                            <span class="training-reward">+15 Insight Value</span>
                        </div>
                    </div>

                    <div class="training-scenario" id="training-scenario" style="display: none;">
                        <!-- Training scenario will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/data/gameData.js"></script>
    <script src="js/game.js"></script>
</body>
</html>
